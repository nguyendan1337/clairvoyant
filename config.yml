---

urls: [
  "https://finance.yahoo.com/markets/etfs/gainers/",
  "https://finance.yahoo.com/markets/etfs/top-performing/",
  "https://finance.yahoo.com/markets/etfs/best-historical-performance/",
  "https://finance.yahoo.com/markets/etfs/top/"
]
excluded_keywords: [
  # Leveraged / inverse / complex / derivative / niche ETFs
  '2x', '3x', 'Ultra', 'Leveraged', 'Bull', 'Bear', 'Double', 'Triple',
  'Enhanced', 'PLUS', 'Short', 'Inverse', 'UltraShort', 'Defined Volatility',
  'Daily', 'Option', 'ETN', 'VIX', 'Junior', 'WeeklyPay', 'Target Income',
  'Covered Call', 'Strategy', 'Derivative', 'Income', 'Bond', 'Futures',
  'Smallcap', 'Microcap', 'Factor', 'Volatility', 'ESG', 'Carbon',
  # Added keywords for foreign/non-US ETFs
  'International', 'Foreign', 'Ex-US', 'Europe', 'Asia', 'Emerging Market',
  'Japan', 'China', 'India', 'Latin America', 'World', 'Developed Market',
  'Israel', 'Mexico', 'Hong Kong', 'Korea', 'Africa', 'Chile', 'Peru', 'Taiwan', 'Netherlands', 'Spain', 'Colombia', 'Finland', 'Brazil'
]
min_52_week_change: 25
min_3_month_return: 6
day_50_average_buffer: 0.98
day_200_average_buffer: 1.05
max_retries: 4
initial_delay: 15
model: gemini-2.5-flash

prompt_selection: |
  You are an investment analyst specializing in recommending U.S. ETFs.

  Your task:
    1. You will be given a **DataFrame containing only the ETFs to consider**. You must use **only these ETFs** — do **not** include, search for, or reference any ETFs that are not in the DataFrame under any circumstances.
    
    2. For each ETF in the DataFrame:
      - Infer its **primary sector or theme** based **only on the ETF name**. 
      - Group ETFs into **logical Sector Groups** of related themes based solely on the ETFs in the DataFrame. Combine sectors or themes that share similar characteristics into the same group.
      - Remove any ETFs from sectors outside the U.S. market (e.g., Emerging Markets, International) from consideration.
    
    3. Within each Sector Group:
      - Rank ETFs based on performance **using only the metrics provided in the DataFrame**, such as '52 WkChange %', '3 MonthReturn', and the 'Price' relative to '50 DayAverage' and '200 DayAverage'.
      - Select up to **4 ETFs per Sector Group** with the best performance.
    
    4. Return your final output list **strictly in JSON format only**, including the following fields for each ETF:
      - **Sector Group**
      - **ETF Name**
      - **Symbol**
      - **52 Wk Change (%)**
      - **3 Mo Return (%)** (estimate based only on the ETF’s data in the DataFrame)
  
  Output example:
    [
      {
        "Sector Group": "Technology",
        "ETF Name": "Invesco QQQ Trust",
        "Symbol": "QQQ",
        "52 Wk Change (%)": "35.2",
        "3 Mo Return (%)": "6.8"
      },
      ...
    ]
  
  Ensure:
    - Do **not** include ETFs not in the DataFrame.
    - Do **not** include ETFs from sectors outside the U.S. market (e.g., Emerging Markets, International).
    - Do **not** perform any searches or lookups.
    - Only use the data provided in the DataFrame for metrics, sector inference.
    - No leading or trailing formatting characters (like ``` or ---)
    - Only valid JSON is returned.
  
  DataSet:
  


prompt_recommendation: |
  You are an investment analyst recommending U.S. based ETFs.  
  Given the following list of ETFs with these columns:
    **Sector Group | ETF Name | Symbol | 52 Wk Change (%) | 3 Mo Return (%)**
  
  Your job is to:
    1. Run 3–4 general searches to understand the current global and macroeconomic backdrop shaping investor sentiment and sector trends.
      Search examples:
        - "Recent global economic and market trends this week"
        - "Latest breakthroughs in technology, AI, robotics, and semiconductors"
        - "Recent clean energy and renewable investment updates"
        - "Current geopolitical tensions, defense spending, and inflation data"
      From these, extract key insights such as:
        - Central bank policies, inflation expectations, or rate guidance
        - Breakthroughs or major announcements in AI, robotics, or semiconductors
        - Clean energy, uranium, or resource investment trends
        - Geopolitical events, defense spending, or trade developments
        Use these insights to inform the broader **market summary** and connect them to the relevant ETF sectors later.
    
    2. Generate the **ETF Recommendations Table**:
      - Research and analyze the ETFs provided to get the latest insights, performance context, and sentiment.
      - Select up to **2 ETFs per Sector Group** that you recommend as likely to continue performing well over the next 12 months.
        Prioritize ETFs and Sector Groups with higher 52 Wk Change (%) and strong recent performance (3 Mo Return %) over lower performers.
      - From the best performing Sector Groups, choose and return up to **10 best performing ETFs** that will continue to perform well in the next year.
      - Include **1–2 sentences of "Key Search Insight"** summarizing what current research or news suggests about that ETF’s outlook.
      - Use **accurate numeric formatting** (e.g., `23.45%`), even if rounded.
      - Include the most recent **"Data as of YYYY-MM-DD"** date based on the last market close you find.
      - Return a **complete HTML table** with:
          - `<table>` element with class `recommendations-table`.
          - `<thead>` with columns: `Sector Group | ETF Name | Symbol | 52 Wk Change (%) | 3 Mo Return (%) | Key Search Insight`.
          - `<tbody>` with one row per ETF.
          - **Clickable links** for Name and Symbol columns:
                          `<a href="https://finance.yahoo.com/quote/<SYMBOL HERE>/" target="_blank"><TEXT HERE></a>`.
          - Truncate or wrap long text in the Key Search Insight column using `<td style="max-width:300px; word-wrap:break-word;">`.
    
    3. Generate the **Summary Block**:
      - Include an exciting greeting and a brief 1–2 sentence <MARKET SUMMARY> explaining recent news, market sentiment, tech trends, etc.
      - For each Sector Group, include a brief summary of why that sector looks promising and a sentence for each recommended ETF.
      - Each Sector Group section should:
          - Begin with the sector name in `<strong>` (e.g., `<p><strong>Technology:</strong> …</p>`).
          - Have exactly **1 sentence** per ETF — balanced, engaging, readable, not wordy.
          - Make sure ETF symbols are **bold and clickable**, using the format:
            `<a href="https://finance.yahoo.com/quote/<SYMBOL HERE>/" target="_blank"><strong><SYMBOL HERE></strong></a>`.
          - Be written in a **friendly, conversational tone** — like explaining to a friend why the sector looks promising.
          - Include **specific real-world news**: recent market trends, Fed policy, consumer demand shifts, geopolitical or supply chain factors, etc.
          - Blend in **current world and macroeconomic context** naturally — reference notable **recent events (within the last few weeks)** such as:
              - central bank policy updates or inflation data
              - major geopolitical tensions or elections
              - breakthroughs or major announcements in **AI, robotics, semiconductors, or clean energy**
              - government funding, trade developments, or regulation changes that affect key sectors
      
      **Summary Block HTML structure example:**
      ```html
      <div class="summary">
      <h2>Market Chat:</h2>
      <p><MARKET SUMMARY HERE></p>
      
      <p><strong><SECTOR GROUP HERE> (<a href="https://finance.yahoo.com/quote/<SYMBOL1>/" target="_blank"><strong>SYMBOL1</strong></a>, <a href="https://finance.yahoo.com/quote/<SYMBOL2>/" target="_blank"><strong>SYMBOL2</strong></a>):</strong> <SECTOR SUMMARY, NEWS, BUY REASONING HERE></p>
      ...
      </div>  
      ```
  
    4. At the very end of the HTML, include a list of sources used for your searches:
      <div class="sources" style="margin-top:10px;font-size:13px;">
        Sources: <LIST OF SEARCH SOURCES HERE>
      </div>
  
  ---
  
  Dataset:
